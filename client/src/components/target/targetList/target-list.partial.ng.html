<header class="header">
    <div class="new-todo-field">
        <div class="target-add-icon" ng-click="vm.addTarget()">
            <i class="fa fa-plus fa-2x"></i>
        </div>
        <input class="new-todo" placeholder="Your next task" autofocus
               ng-focus="showTaskCreateOption = true"
               ng-model="vm.taskName">
    </div>
    <div class="row"
         ng-show="showTaskCreateOption">
        <div class="col-md-3 goalValue-field">
            <div class="input-block"
                 ng-show="goalValueEditMode">
                <input type="text" placeholder="goal value" autofocus ng-model="vm.goalValue">
            </div>
            <label
                    ng-click="goalValueEditMode = true"
                    ng-show="!goalValueEditMode">
                goal value
            </label>
        </div>
        <div class="col-md-3 metric-field">
            <div class="input-block"
                 ng-show="metricEditMode">
                <input type="text" placeholder="metric" autofocus ng-model="vm.metric">
            </div>
            <label
                    ng-click="metricEditMode = true"
                    ng-show="!metricEditMode">
                metric
            </label>
        </div>
        <div class="col-md-3 frequency-field">
            <div class="input-block"
                 ng-show="frequencyEditMode">
                <select class="form-control"
                        ng-model="vm.frequency"
                        ng-options="frequency.name for frequency in vm.frequencies">
                    <option value="">Select frequency</option>
                </select>
            </div>
            <label
                    ng-click="frequencyEditMode = true"
                    ng-show="!frequencyEditMode">
                frequency
            </label>
        </div>
        <div class="col-md-3 due-date-field">
            <div class="input-block"
                 ng-show="dueDateEditMode">
                <date-picker-custom date="vm.goalDate"></date-picker-custom>
            </div>
            <label
                    ng-click="dueDateEditMode = true"
                    ng-show="!dueDateEditMode">
                due date
            </label>
        </div>
    </div>
</header>
<section class="main">
    <ul class="todo-list">
        <li ng-repeat="item in vm.targets | targetFilter:vm.metricService.target.metric:vm.targetsType | filter:vm.metricService.searchQuery track by $index"
            ng-class="vm.isTaksCompleted(item) ? 'completed' : ''" class="todo-list-item">
            <div class="view">
                <input class="toggle checkbox" type="checkbox"
                   ng-hide="vm.track === $index"
                   ng-click="vm.track = $index; vm.currentValue =''"
                   ng-checked="vm.isTaksCompleted(item)">
                <div class="toggle" ng-show="vm.track === $index">
                    <input type="text" placeholder="hello" ng-model="vm.currentValue">
                    <div ng-click="vm.trackTarget(vm.currentValue, $index)" class="btn btn-success">ok</div>
                </div>
                <div class="task-content">
                  <div class="task-name" ng-bind="item.name"></div>

                  <div class="task-options">
                      <div class="task-options-item" ng-if="item.goalValue" ng-bind="vm.getTotal(item.progress) + '/'+item.goalValue"></div>
                      <div class="task-options-item" ng-bind="item.metric"> </div>
                      <div class="task-options-item" ng-if="vm.countTotalProgress(item.progress,item.goalValue)" ng-bind="vm.countTotalProgress(item.progress,item.goalValue)  + '%'"></div>
                      <div class="task-options-item" ng-if="vm.shoulDo(item)" ng-bind="vm.shoulDo(item) + ' per ' + vm.getMetric(item.frequency)"></div>
                      <div class="task-options-item" ng-bind="vm.getTotal(item.progress, true) +' '+ item.metric +' today'"></div>
                      <div class="task-options-item">{{item.goalDate | date}}</div>
                  </div>
                </div>
                <button class="delete"></button>
            </div>
        </li>
    </ul>
</section>
<footer class="footer">
    <span class="todo-count"><strong ng-bind='vm.targets.length'></strong> item left</span>
    <ul class="filters">
        <li>
            <a href="#" ng-class="vm.isTargetsTypeAll() ? 'selected' : ''"
               ng-click="vm.showAllTargets()">
                All [12]
            </a>
        </li>
        <li>
            <a href="#" ng-class="vm.isTargetsTypeActive() ? 'selected' : ''"
               ng-click="vm.showActiveTargets()">
                Active [12]
            </a>
        </li>
        <li>
            <a href="#" ng-class="vm.isTargetsTypeCompleted() ? 'selected' : ''"
               ng-click="vm.showCompletedTargets()">
                Completed [1]
            </a>
        </li>
    </ul>
</footer>
